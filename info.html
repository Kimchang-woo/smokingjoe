<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ìï¥Ïö¥ÎåÄ Í¥ÄÍ¥ë Ï†ïÎ≥¥</title>
    <script defer src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript"
        src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=2237e1d4164afe675ac45fd0c6310ad4&libraries=services&autoload=false"></script>

    <style>
        @font-face {
            font-family: 'MyFont';
            src: url(../BusanFont.ttf) format('ttf');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: 'MyFont', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            width: 100vw;
        }

        /* Ìó§Îçî Ïä§ÌÉÄÏùº */
        #map {
            width: 100%;
            height: 500px;
        }

        .toggle-traffic {
            margin: 10px 0;
            padding: 10px;
            background-color: #002d72;
            color: white border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 5px;
        }


        .toggle-traffic:hover {
            background: #ff5910;
        }

        header {
            display: flex;
            width: 100%;
            height: 8rem;
            justify-content: space-between;
            align-items: center;
            background-color: #002d72;
            padding: 0 2rem;
        }

        .logo {
            width: 7rem;
            height: 7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 80%;
            height: auto;
            object-fit: contain;
        }

        nav {
            display: flex;
            color: #ffffff;
            justify-content: space-around;
            width: 50rem;
            font-size: 1.8rem;
            font-weight: bold;
        }

        .hdicons {
            width: 12rem;
            height: 7rem;
            margin-right: 10rem;
            color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .naticon {
            background-image: url(../image/home/korea.png);
            width: 3rem;
            height: 2rem;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
        }

        .naticon:hover .naticonsub {
            opacity: 1;
        }

        .naticonsub {
            position: relative;
            top: 4rem;
            right: 1.8rem;
            background-color: #002d72;
            width: 5.5rem;
            padding: 0.5rem;
            border: 0.2rem solid #ff5910;
            border-radius: 10%;
            opacity: 0;
            transition: 0.5s;
        }

        .subnat {
            display: flex;
            justify-content: start;
            align-items: center;
        }

        .naticonsub img {
            width: 3rem;
            height: 2rem;
            padding: 0.2rem;
            margin-right: 0.2rem;
        }

        /* ÏÑπÏÖò Î†àÏù¥ÏïÑÏõÉ */
        .section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%
        }

        #container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .blankY {
            width: 100%;
            height: 80px;
        }

        .boxTitle {
            display: block;
            font-size: 1.8rem;
            font-weight: bold;
            letter-spacing: 1px;
            

        }

        /********** Ï≤´ Î≤àÏß∏ Ï§Ñ ***********/
        .weather-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            width: 96%;
            margin-bottom: 50px;
        }

        /********** Îëê Î≤àÏß∏ Ï§Ñ **********/


        /*********** ÏÑ∏ Î≤àÏß∏ Ï§Ñ ***********/
        .directions-box {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            width: 90%;
        }

        /* ÎÇ†Ïî® ÏïÑÏù¥ÏΩò */
        .weather-icon {
            width: 5rem;
            height: auto;
            margin-left: auto;
        }

        /* ÎÇ†Ïî® ÌÖçÏä§Ìä∏ */
        .weather-text {
            font-size: 1.2rem;
            line-height: 1.5;
        }

        .weather-box,
        .forecast-box,
        .search-box,
        .directions-box {
            text-align: center;
            margin: auto;
            padding: 10px;
            border: none;
            border-radius: 6px;
            background-color: rgba(250, 250, 250, 0.7);
            overflow: hidden;
        }

        .weather-box,
        .forecast-box {
            width: 48%;
            height: 15rem;
            padding: 10px;
            border: none;
            background-color: rgba(250, 250, 250, 0.7);
            border-radius: 6px;
            box-sizing: border-box;
        }

        .search-box {
            width: 48%;
            height: 12rem;
            padding: 10px;
            border: none;
            background-color: #f9f9f9;
            box-sizing: border-box;
        }

        #forecast {
            list-style: none;
            padding: 0;
            margin: 0;

        }

        .forecast-item {
            text-align: left;
            padding-left: 50px;
            display: flex;
            align-items: center;

        }

        .forecast-detail1 {
            display: inline-block;
            vertical-align: middle;
        }

        .forecast-item img {
            margin-right: 10px;
        }

        .directions-box {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            margin-top: 10px;
        }

        .directions-box {
            width: 91%;
            margin-bottom: 19px;
        }

        .directions-box button {
            width: 100px;
            height: 60px;
            padding: 10px;
            background: #002d72;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 5px;
        }

        .directions-box button:hover {
            background: #ff5910;
        }

        .directions-box h2 {
            width: 100%;
            text-align: center;
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 20px;
            padding: 0;

        }

        .search-box input {
            padding: 5px;
            width: 50%;
        }

        .search-box button {
            padding: 6px 10px;
            background: blue;
            color: white;
            border: none;
            cursor: pointer;
        }


        @media (max-width: 1100px) {

            .forecast-item {
                padding-left: 10px;
                display: flex;
                align-items: center;
            }
        }


        @media (max-width: 850px) {
            .forecast-detail1 {
                display: none;
            }
            .forecast-detail2 {
                display: none;
            
            }

        }

        @media (max-width: 600px) {
            .forecast-detail2 {
                display: none;
                font-size: 1rem;
            }
            .forecast-detail3 {
                font-size: 13px;
            }

        }
    </style>
</head>

<body>

    <header>
        <div class="logo">
            <img src="./image/home/logo.png" alt="Î°úÍ≥†">
        </div>
        <nav>
            <div>TOUR</div>
            <div>FOOD</div>
            <div>STAY</div>
            <div>INFO</div>
        </nav>
        <div class="hdicons">
            <div class="naticon">
                <div class="naticonsub">
                    <div class="subnat"><img src="./image/home/america.png" alt="usa">ENG</div>
                    <div class="subnat"><img src="./image/home/japan.png" alt="japan">JAP</div>
                    <div class="subnat"><img src="./image/home/china.png" alt="china">CHI</div>
                </div>
            </div>
        </div>
    </header>
    <!-- ÏÑπÏÖòÏãúÏûëÏûÑ -->
    <section class="section"
        style="background-image: url('./image/info/infobg2.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
        <div id="container">
            <div class="blankY"></div>
            <div class="weather-container">
                <div class="weather-box">
                    <h2 class="boxTitle">ÌòÑÏû¨ÎÇ†Ïî®</h2>
                    <div class="weather-content">
                        <img id="weather-icon" class="weather-icon" src="" alt="ÎÇ†Ïî® ÏïÑÏù¥ÏΩò">
                        <div id="weather-text" class="weather-text"></div>
                    </div>
                </div>

                <div class="forecast-box">
                    <h2 class="boxTitle">ÏùºÍ∏∞ÏòàÎ≥¥</h2>
                    <ul id="forecast">Loading...</ul>
                </div>
            </div>

            <div class="directions-box">
                <h2>üö¶ Ïã§ÏãúÍ∞Ñ ÍµêÌÜµÏ≤¥Ï¶ù</h2>
                <button onclick="openDirections('Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•')">Ìï¥Ïö¥ÎåÄ<br>Ìï¥ÏàòÏöïÏû•</button>
                <button onclick="openDirections('ÏÜ°Ï†ïÌï¥ÏàòÏöïÏû•')">ÏÜ°Ï†ï<br>Ìï¥ÏàòÏöïÏû•</button>
                <button onclick="openDirections('ÎèôÎ∞±ÏÑ¨')">ÎèôÎ∞±ÏÑ¨</button>
                <button onclick="openDirections('Îã¨ÎßûÏù¥Í∏∏')">Îã¨ÎßûÏù¥Í∏∏</button>
                <button onclick="openDirections('ÎçîÎ≤†Ïù¥101')">ÎçîÎ≤†Ïù¥<br>101</button>
                <button onclick="openDirections('ÏÑºÌÖÄÏãúÌã∞')">ÏÑºÌÖÄÏãúÌã∞</button>
                <button onclick="openDirections('Ìï¥Ïö¥ÎåÄÏ†ÑÌÜµÏãúÏû•')">Ìï¥Ïö¥ÎåÄ<br>Ï†ÑÌÜµÏãúÏû•</button>
                <button onclick="openDirections('Î∏îÎ£®ÎùºÏù∏ÌååÌÅ¨')">Î∏îÎ£®<br>ÎùºÏù∏ÌååÌÅ¨</button>
                <div id="map"></div>
            </div>

            <div class="directions-box">
                <h2>üöó ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò</h2>
                <button id="navbtn" onclick="searchPlace('Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•')">Ìï¥Ïö¥ÎåÄ<br>Ìï¥ÏàòÏöïÏû•</button>
                <button id="navbtn" onclick="searchPlace('ÏÜ°Ï†ïÌï¥ÏàòÏöïÏû•')">ÏÜ°Ï†ï<br>Ìï¥ÏàòÏöïÏû•</button>
                <button id="navbtn" onclick="searchPlace('ÎèôÎ∞±ÏÑ¨')">ÎèôÎ∞±ÏÑ¨</button>
                <button id="navbtn" onclick="searchPlace('Îã¨ÎßûÏù¥Í∏∏')">Îã¨ÎßûÏù¥Í∏∏</button>
                <button id="navbtn" onclick="searchPlace('ÎçîÎ≤†Ïù¥101')">ÎçîÎ≤†Ïù¥<br>101</button>
                <button id="navbtn" onclick="searchPlace('ÏÑºÌÖÄÏãúÌã∞')">ÏÑºÌÖÄÏãúÌã∞</button>
                <button id="navbtn" onclick="searchPlace('Ìï¥Ïö¥ÎåÄÏ†ÑÌÜµÏãúÏû•')">Ìï¥Ïö¥ÎåÄ<br>Ï†ÑÌÜµÏãúÏû•</button>
                <button id="navbtn" onclick="searchPlace('Î∏îÎ£®ÎùºÏù∏ÌååÌÅ¨')">Î∏îÎ£®<br>ÎùºÏù∏ÌååÌÅ¨</button>
            </div>



        </div>
    </section>


    <script>
        const weatherApiKey = 'a64a5c4f491cc98941022c90285932bc';
        const city = 'Busan';

        function getWeatherIcon(weatherMain, weatherDescription, isDaytime) {
            const iconMap = {
                "Clear": isDaytime ? "01d.png" : "01n.png",
                "Few Clouds": isDaytime ? "02d.png" : "02n.png",
                "Scattered Clouds": "03d.png",
                "Broken Clouds": isDaytime ? "04d.png" : "04n.png",
                "Clouds": "03d.png",
                "Shower Rain": isDaytime ? "09d.png" : "09n.png",
                "Rain": isDaytime ? "10d.png" : "10n.png",
                "Thunderstorm": isDaytime ? "11d.png" : "11n.png",
                "Snow": isDaytime ? "13d.png" : "13n.png",
                "Mist": isDaytime ? "50d.png" : "50n.png"
            };

            return iconMap[weatherMain] || "01d.png";
        }

        function fetchWeather() {
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${weatherApiKey}&units=metric&lang=kr`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    console.log("API ÏùëÎãµ (ÌòÑÏû¨ ÎÇ†Ïî®):", data);

                    const weatherMain = data.weather[0].main;
                    const weatherDescription = data.weather[0].description;
                    const temperature = data.main.temp;
                    const cloudiness = data.clouds.all;
                    const currentHour = new Date().getHours();
                    const isDaytime = currentHour >= 6 && currentHour < 18;
                    const iconFileName = getWeatherIcon(weatherMain, weatherDescription, isDaytime);
                    const iconPath = `./image/info/${iconFileName}`;

                    console.log("Ïù¥ÎØ∏ÏßÄ Í≤ΩÎ°ú:", iconPath);

                    // ÏïÑÏù¥ÏΩò Î∞è ÌÖçÏä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                    document.getElementById('weather-icon').src = iconPath;
                    document.getElementById('weather-text').innerHTML =
                        `"${weatherDescription}" [ üå°Ô∏è: ${temperature.toFixed(1)}¬∞C <span class="forecast-detail1">/ üí¶: ${cloudiness}%</span> ]`;
                })
                .catch(error => {
                    console.error("ÎÇ†Ïî® API Ìò∏Ï∂ú Ïã§Ìå®:", error);
                    document.getElementById('weather-text').innerText = 'ÎÇ†Ïî® Ï†ïÎ≥¥ Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®';
                });
        }

        function fetchForecast() {
            const url = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${weatherApiKey}&units=metric&lang=kr`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    console.log("API ÏùëÎãµ (ÏùºÍ∏∞ÏòàÎ≥¥):", data);

                    const forecasts = data.list
                        .filter((_, index) => index % 8 == 0)
                        .slice(0, 4)
                        .map(entry => {
                            const date = new Date(entry.dt * 1000);
                            const formattedDate = date.toLocaleDateString('ko-KR');
                            const isDaytime = date.getHours() >= 6 && date.getHours() < 18;
                            const forecastMain = entry.weather[0].main;
                            const forecastDescription = entry.weather[0].description;
                            const cloudiness = entry.clouds.all;
                            const forecastIconFileName = getWeatherIcon(forecastMain, forecastDescription, isDaytime);
                            const forecastIconPath = `./image/info/${forecastIconFileName}`;

                            console.log("ÏòàÎ≥¥ ÎÇ†Ïßú:", formattedDate, "ÏïÑÏù¥ÏΩò Í≤ΩÎ°ú:", forecastIconPath);

                            return `<li class="forecast-item">
                        <img src="${forecastIconPath}" alt="ÏòàÎ≥¥ ÏïÑÏù¥ÏΩò" style="width:30px; height:30px; vertical-align:middle;">
                       <span class ="forecast-detail2">${formattedDate}</span> <span class="forecast-detail1">"${forecastDescription}"</span><span class = "forecast-detail3">[üå°Ô∏è : ${entry.main.temp.toFixed(1)}¬∞C / üí¶ : ${cloudiness}% ]
                    </span></li>`;
                        })
                        .join('');

                    document.getElementById('forecast').innerHTML = forecasts;
                })
                .catch(error => {
                    console.error("ÏòàÎ≥¥ API Ìò∏Ï∂ú Ïã§Ìå®:", error);
                    document.getElementById('forecast').innerHTML = 'ÎÇ†Ïî® ÏòàÎ≥¥ Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®';
                });
        }
        fetchWeather();
        fetchForecast();

        //--------------------------------------------------ÎÇ†Ïî® ÎÅù
        let center = {
            "Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•": { lat: 35.1587, lng: 129.1604 },
            "ÏÜ°Ï†ïÌï¥ÏàòÏöïÏû•": { lat: 35.1800, lng: 129.1994 },
            "ÎèôÎ∞±ÏÑ¨": { lat: 35.1532, lng: 129.1527 },
            "Îã¨ÎßûÏù¥Í∏∏": { lat: 35.1674, lng: 129.1780 },
            "ÎçîÎ≤†Ïù¥101": { lat: 35.1535, lng: 129.1520 },
            "ÏÑºÌÖÄÏãúÌã∞": { lat: 35.1698, lng: 129.1307 },
            "Ìï¥Ïö¥ÎåÄÏ†ÑÌÜµÏãúÏû•": { lat: 35.1633, lng: 129.1633 },
            "Î∏îÎ£®ÎùºÏù∏ÌååÌÅ¨": { lat: 35.1601, lng: 129.1635 }
        };

        let map, marker, infowindow;
        let trafficLayerOn = false;

        function initMap() {
            var mapContainer = document.getElementById('map');

            if (!mapContainer) {
                console.error("map ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.");
                return;
            }

            var mapOption = {
                center: new kakao.maps.LatLng(center["Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•"].lat, center["Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•"].lng), // Í∏∞Î≥∏ Ï§ëÏã¨ (Ìï¥Ïö¥ÎåÄ Ìï¥ÏàòÏöïÏû•)
                level: 4
            };

            map = new kakao.maps.Map(mapContainer, mapOption);
            marker = new kakao.maps.Marker({
                position: new kakao.maps.LatLng(center["Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•"].lat, center["Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•"].lng),
                map: map
            });

            infowindow = new kakao.maps.InfoWindow({ zIndex: 1 });
            infowindow.setContent(`<div style="padding:5px; font-size:14px; text-align: center;">Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•</div>`);
            infowindow.open(map, marker);

            //  Í∏∞Î≥∏Ï†ÅÏúºÎ°ú ÍµêÌÜµÏ†ïÎ≥¥ Ï∂îÍ∞Ä
            map.addOverlayMapTypeId(kakao.maps.MapTypeId.TRAFFIC);
            trafficLayerOn = true;

            // ÏßÄÎèÑÍ∞Ä Î≥¥Ïù¥Îäî ÏãúÏ†êÏóê relayout Ï†ÅÏö©
            setTimeout(() => {
                console.log("map.relayout() Ïã§Ìñâ");
                map.relayout();
            }, 500);
        }

        function openDirections(place) {
            if (!center[place]) {
                alert("Ïû•ÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.");
                return;
            }

            var position = new kakao.maps.LatLng(center[place].lat, center[place].lng);
            map.setCenter(position);

            if (marker) {
                marker.setMap(null);
            }

            marker = new kakao.maps.Marker({
                position: position,
                map: map
            });

            infowindow.setContent(`<div style="padding:5px; font-size:14px; text-align: center;">${place}</div>`);
            infowindow.open(map, marker);
        }

        function toggleTraffic() {
            if (trafficLayerOn) {
                map.removeOverlayMapTypeId(kakao.maps.MapTypeId.TRAFFIC);
                trafficLayerOn = false;
                console.log("üö¶ ÍµêÌÜµÏ†ïÎ≥¥ OFF");
            } else {
                map.addOverlayMapTypeId(kakao.maps.MapTypeId.TRAFFIC);
                trafficLayerOn = true;
                console.log("üö¶ ÍµêÌÜµÏ†ïÎ≥¥ ON");
            }
        }

        //Kakao API Î°úÎìú ÌõÑ Ïã§Ìñâ
        kakao.maps.load(initMap);

        // Ïç®ÏπòÌîåÎ†àÏù¥Ïì∞
        function searchPlace(place) {
            window.open(`https://map.kakao.com/?q=${place}`, '_blank');
        }

        document.addEventListener('DOMContentLoaded', () => {

            document.getElementById('searchBtn').addEventListener('click', () => {
                const query = document.getElementById('searchQuery').value.trim();
                if (query) window.open(`https://map.kakao.com/?q=${query}`, '_blank');
            });
        });

    </script>

</body>

</html>